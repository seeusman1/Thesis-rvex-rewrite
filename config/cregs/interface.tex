
\interface{}

%===============================================================================
\ifaceGroup{Run control interface}
%===============================================================================
\ifaceSubGroup{}
\ifaceInCtxt{rctrl}{reset}{bit}
Active high context reset input. When high, the context control registers 
(including PC, done and break flag) will be reset.
    
\ifaceSubGroup{}
\ifaceInCtxt{rctrl}{resetVect}{address}
Reset vector. When the context or the entire core is reset, the PC register will 
be set to this value.
    
\ifaceSubGroup{}
\ifaceOutCtxt{rctrl}{done}{bit}
Active high done output. This is asserted when the context encounters a stop 
syllable. Processing a stop signal also sets the BRK control register, which 
stops the core. This bit can be reset by issuing a core reset or by means of the 
debug interface.

%===============================================================================
\ifaceGroup{Pipelane interface: misc}
%===============================================================================
\ifaceSubGroup{}
\ifaceInCtxt{cxplif}{stall}{bit}
When high, the context registers must maintain their current value.

\ifaceSubGroup{}
\ifaceInCtxt{cxplif}{idle}{bit}
Idle flag, as reported to the external run control interface. Used for the 
performance counters.

\ifaceSubGroup{}
\ifaceInCtxt{cxplif}{sylCommit}{sylStatus}
Syllable committed flag for each lane, used for the performance counters.
    
\ifaceSubGroup{}
\ifaceInCtxt{cxplif}{sylNop}{sylStatus}
NOP flag for each lane with the same timing as sylCommit, used for the 
performance counters.

\ifaceSubGroup{}
\ifaceInCtxt{cxplif}{stop}{bit}
Stop flag. When high, the BRK and done flags in the debug control
register should be set.
    
%===============================================================================
\ifaceGroup{Pipelane interface: branch/link registers}
%===============================================================================
\ifaceSubGroup{}
\ifaceInCtxt{cxplif}{brWriteData}{brRegData}
\ifaceInCtxt{cxplif}{brWriteEnable}{brRegData}
Write data and enable signal for each branch register.
    
\ifaceSubGroup{}
\ifaceOutCtxt{cxplif}{brReadData}{brRegData}
Current state of the branch registers.
    
\ifaceSubGroup{}
\ifaceInCtxt{cxplif}{linkWriteData}{data}
\ifaceInCtxt{cxplif}{linkWriteEnable}{bit}
Write data and enable signal for the link register.
    
\ifaceSubGroup{}
\ifaceOutCtxt{cxplif}{linkReadData}{data}
Current state of the link register.

%===============================================================================
\ifaceGroup{Pipelane interface: program counter}
%===============================================================================
\ifaceSubGroup{}
\ifaceInCtxt{cxplif}{nextPC}{address}
Next value for the PC register. This is written when stall is low and overridePC 
is not asserted.

\ifaceSubGroup{}
\ifaceOutCtxt{cxplif}{currentPC}{address}
Current value of the PC register.

\ifaceSubGroup{}
\ifaceOutCtxt{cxplif}{overridePC}{bit}
\ifaceInCtxt{cxplif}{overridePC_ack}{bit}
The overridePC flag is set when the debug bus writes to the context registers or 
when the context or processor is reset. This is reset when overridePC_ack is 
asserted while stall is low. It indicates to the branch unit that it should 
inject a branch to the current PC register regardless of the current instruction 
or state.

%===============================================================================
\ifaceGroup{Pipelane interface: trap handling}
%===============================================================================
\ifaceSubGroup{}
\ifaceOutCtxt{cxplif}{trapHandler}{address}
Current trap handler. When the application has marked that it is not currently 
capable of accepting a trap, this is set to the panic handler register instead.

\ifaceSubGroup{}
\ifaceInCtxt{cxplif}{trapInfo_active}{bit}
\ifaceInCtxt{cxplif}{trapInfo_cause}{trapCause}
\ifaceInCtxt{cxplif}{trapInfo_arg}{address}
\ifaceInCtxt{cxplif}{trapPoint}{address}
Regular trap information. When the trap in trapInfo is active, the trap 
information should be stored in the trap cause/arg registers. In addition, the 
register hardware should save the current value of the control register and 
should clear the ready-for-trap and interrupt- enable bits, as well as the 
debug-trap-enable bit if the trap cause maps to a debug trap.

\ifaceSubGroup{}
\ifaceOutCtxt{cxplif}{trapReturn}{address}
Connected to the current value of the trap point register. Used by the branch 
unit as the return address for the RFI instruction.

\ifaceSubGroup{}
\ifaceInCtxt{cxplif}{rfi}{bit}
RFI flag. When high, the saved control register value should be restored and the 
trap cause field should be set to 0.

\ifaceSubGroup{}
\ifaceOutCtxt{cxplif}{handlingDebugTrap}{bit}
Set when the current value of the trap cause register maps to a debug trap. This 
is used by the branch unit to disable breakpoints for the first instruction 
executed after the debug trap returns.

\ifaceSubGroup{}
\ifaceOutCtxt{cxplif}{interruptEnable}{bit}
Current value of the interrupt-enable flag in the control register.

\ifaceSubGroup{}
\ifaceOutCtxt{cxplif}{debugTrapEnable}{bit}
Current value of the debug-trap-enable flag in the control register.

\ifaceSubGroup{}
\ifaceOutCtxt{cxplif}{breakpoints_addr_0}{address}
\ifaceOutCtxt{cxplif}{breakpoints_addr_1}{address}
\ifaceOutCtxt{cxplif}{breakpoints_addr_2}{address}
\ifaceOutCtxt{cxplif}{breakpoints_addr_3}{address}
\ifaceOutCtxt{cxplif}{breakpoints_cfg_0}{twoBit}
\ifaceOutCtxt{cxplif}{breakpoints_cfg_1}{twoBit}
\ifaceOutCtxt{cxplif}{breakpoints_cfg_2}{twoBit}
\ifaceOutCtxt{cxplif}{breakpoints_cfg_3}{twoBit}
Current hardware breakpoint configuration. The cfg fields have the following
encoding:
 - 00 -> breakpoint disabled.
 - 01 -> instruction breakpoint.
 - 10 -> data write breakpoint.
 - 11 -> data access breakpoint.
All these signals map to a single cregl2pl_breakpoint_info_type, but the
control register generator does not support structures.

%===============================================================================
\ifaceGroup{Pipelane interface: external debug control signals}
%===============================================================================
\ifaceSubGroup{}
\ifaceOutCtxt{cxplif}{extDebug}{bit}
Whether debug traps are to be handled normally or by halting execution for 
debugging through the external bebug bus.

\ifaceSubGroup{}
\ifaceInCtxt{cxplif}{exDbgTrapInfo_active}{bit}
\ifaceInCtxt{cxplif}{exDbgTrapInfo_cause}{trapCause}
External debug trap information. When the trap in exDbgTrapInfo is active, the 
trap cause should be stored in the debug control register and the BRK flag in 
the debug control register should be set.

\ifaceSubGroup{}
\ifaceOutCtxt{cxplif}{brk}{bit}
BRK flag from the debug control register. When high, the core should be halted.

\ifaceSubGroup{}
\ifaceOutCtxt{cxplif}{stepping}{bit}
Stepping mode flag from the debug control register. When high, executing any 
instruction which has the brkValid flag set should cause a step trap.

\ifaceSubGroup{}
\ifaceOutCtxt{cxplif}{resuming}{bit}
\ifaceInCtxt{cxplif}{resuming_ack}{bit}
Resuming flag. This is set when the BRK flag is cleared by the debug bus. It is 
cleared when the resumed bit is high while stall is low. While high, issued 
instructions should have the brkValid flag cleared, so breakpoints and step 
traps are ignored.
    
%===============================================================================
\ifaceGroup{Interface with configuration logic}
%===============================================================================
\ifaceSubGroup{}
\ifaceOutCtxt{cfg}{requestData_r}{data}
\ifaceOutCtxt{cfg}{requestEnable}{bit}
Each nibble in the data word corresponds to a pipelane group, of which bit 3 
specifies whether the pipelane group should be disabled (high) or enabled (low) 
and, if low, bit 2..0 specify the context it should run on. Bits which are not 
supported by the core (as specified in the CFG generic) should be written zero 
or the request will be ignored (as specified by the error flag in the global 
control register file). The enable signal is active high, and is valid one 
clkEn'd cycle BEFORE the data vector is. This is because the enable signal is 
connected to the bus write enable signal for the register and the data is 
connected to the register output.

\ifaceSubGroup{}
\ifaceOut{cfg}{dbgRequestData_r}{data}
\ifaceOut{cfg}{dbgRequestEnable}{bit}
Same as above, but for the debug bus request instead of the context request.

\ifaceSubGroup{}
\ifaceIn{cfg}{currentCfg}{data}
Current configuration, using the same encoding as the request data.
    
\ifaceSubGroup{}
\ifaceIn{cfg}{busy}{bit}
Configuration busy signal. When set, new configuration requests are not 
accepted.
    
\ifaceSubGroup{}
\ifaceIn{cfg}{error}{bit}
Configuration error signal. This is set when the last configuration request was 
erroneous.
    
\ifaceSubGroup{}
\ifaceIn{cfg}{requesterID}{bit(3..0)}
When reconfiguration is requested, this field is set to the index of the context 
which requested the configuration, or all ones if the source was the debug bus.

%===============================================================================
\ifaceGroup{Interface with memory}
%===============================================================================
\ifaceSubGroup{}
\ifaceIn{imem}{affinity}{data}
Affinity signal from the memory.

%===============================================================================
\ifaceGroup{Trace control unit interface}
%===============================================================================
\ifaceSubGroup{}
\ifaceOutCtxt{trace}{enable}{bit}
Whether tracing should be enabled or not for each context. Active high.
    
\ifaceSubGroup{}
\ifaceOutCtxt{trace}{trapEn}{bit}
Whether trap information should be traced. Active high.
    
\ifaceSubGroup{}
\ifaceOutCtxt{trace}{memEn}{bit}
Whether memory operations should be traced. Active high.
    
\ifaceSubGroup{}
\ifaceOutCtxt{trace}{regEn}{bit}
Whether register writes should be traced. Active high.
    
\ifaceSubGroup{}
\ifaceOutCtxt{trace}{cacheEn}{bit}
Whether cache performance information should be traced. Active high.
    
\ifaceSubGroup{}
\ifaceOutCtxt{trace}{instrEn}{bit}
Whether instructions (the raw syllables) should be traced. Active high.
