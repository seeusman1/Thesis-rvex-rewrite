
# ALMARVI interface registers. NOTE: these are little endian, while rvd will
# interpret them as big endian!
all: A_PC         { 0x00000004 }
all: A_CYC        { 0x00000008 }
all: A_LCYC       { 0x0000000C }
all: A_CMD        { 0x00000200 }
all: A_CMD_RST    { 1 }
all: A_CMD_RUN    { 2 }
all: A_START      { 0x00000204 }
all: A_DEV_CLS    { 0x00000300 }
all: A_DEV_ID     { 0x00000304 }
all: A_IFACE      { 0x00000308 }
all: A_DMEM       { 0x0000030C }
all: A_IMEM       { 0x00000310 }
all: A_PMEM       { 0x00000314 }
all: A_SIZE       { 0x00000318 } # Total interface size. Not in the specs currently.

all: A_SIZE_DEREF {
  set(val, readWord(A_SIZE));
  set(val, 
    ((val & 0xFF000000) >> 24) |
    ((val & 0x00FF0000) >>  8) |
    ((val & 0x0000FF00) <<  8) |
    ((val & 0x000000FF) << 24)
  );
  set(A_PERIPH_SIZE, val);
  val
}

# r-VEX trace buffer.
all: _TRACE_ADDR  { 0x00000800 }
all: _TRACE_SIZE  { 0x00000800 }

# r-VEX control registers.
all: CREG         { 0x00001000 }
all:_NUM_CONTEXTS {
  set(val, readWord(DCFG));
  set(_NUM_CONTEXTS, FIELD_DCFG_NC+1);
  FIELD_DCFG_NC+1
}

# Accelerator local memories.
all: IMEM         { (A_SIZE_DEREF / 4) * 1 }
all: DMEM         { (A_SIZE_DEREF / 4) * 2 }
all: PMEM         { (A_SIZE_DEREF / 4) * 3 }

